<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Draggable Learning Clock</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        function SpinningClock() {
            const [hourRotation, setHourRotation] = useState(0);
            const [minuteRotation, setMinuteRotation] = useState(0);
            const [isDraggingHour, setIsDraggingHour] = useState(false);
            const [isDraggingMinute, setIsDraggingMinute] = useState(false);

            const hours = Array.from({ length: 12 }, (_, i) => i + 1); // [1, 2, ..., 12]
            const minutes = [0, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50, 55];

            const calculateRotation = (e, centerX, centerY) => {
                const x = e.clientX - centerX;
                const y = e.clientY - centerY;
                // Add 90 degrees to make 12 o'clock (top) the reference point (0 degrees for a hand pointing up)
                return Math.atan2(y, x) * (180 / Math.PI) + 90;
            };

            const handleMouseDown = (type) => {
                if (type === 'hour') setIsDraggingHour(true);
                else setIsDraggingMinute(true);
            };

            const handleMouseMove = (e, type) => {
                if ((type === 'hour' && !isDraggingHour) || (type === 'minute' && !isDraggingMinute)) return;
                
                const clockContainer = document.getElementById('clock-container');
                if (!clockContainer) return;

                const rect = clockContainer.getBoundingClientRect();
                const centerX = rect.left + rect.width / 2;
                const centerY = rect.top + rect.height / 2;
                const rotation = calculateRotation(e, centerX, centerY);
                
                if (type === 'hour') setHourRotation(rotation);
                else setMinuteRotation(rotation);
            };

            const handleMouseUp = () => {
                setIsDraggingHour(false);
                setIsDraggingMinute(false);
            };

            const getCurrentHour = () => {
                // Normalize rotation to 0-360 range
                const normalizedRotation = ((hourRotation % 360) + 360) % 360;
                // Calculate which of the 12 segments the rotation falls into
                const hourIndex = Math.round(normalizedRotation / 30) % 12;
                // 0 index means 12 o'clock
                return hourIndex === 0 ? 12 : hourIndex;
            };

            const getCurrentMinute = () => {
                const normalizedRotation = ((minuteRotation % 360) + 360) % 360;
                const minuteSegmentIndex = Math.round(normalizedRotation / 30) % 12;
                return minuteSegmentIndex * 5;
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-blue-50 to-purple-50 p-8 flex flex-col items-center justify-center"
                    onMouseMove={(e) => {
                        handleMouseMove(e, 'hour');
                        handleMouseMove(e, 'minute');
                    }}
                    onMouseUp={handleMouseUp}
                    onMouseLeave={handleMouseUp}>
                
                    <h1 className="text-4xl font-bold text-gray-800 mb-2">Learning Clock</h1>
                    <p className="text-gray-600 mb-8">Drag the hands to set the time!</p>

                    <div className="bg-white rounded-3xl shadow-2xl p-8 mb-6">
                        <div id="clock-container" className="relative w-96 h-96">
                            
                            {/* Minute petals (outer ring) */}
                            {minutes.map((minute, index) => {
                                // Angle: index 0 (0 minutes) should be at the top (-90 degrees)
                                const angle = (index * 30) - 90; 
                                const radian = angle * (Math.PI / 180);
                                const x = Math.cos(radian) * 170 + 192; // 192 is center X
                                const y = Math.sin(radian) * 170 + 192; // 192 is center Y
                                
                                return (
                                    <div
                                        key={`min-${minute}`}
                                        className="absolute w-14 h-14 bg-yellow-400 rounded-full flex items-center justify-center font-bold text-sm shadow-md transform -translate-x-1/2 -translate-y-1/2"
                                        style={{ left: `${x}px`, top: `${y}px` }}
                                    >
                                        :{minute.toString().padStart(2, '0')}
                                    </div>
                                );
                            })}

                            {/* Hour petals (inner ring) - FIXED POSITIONING */}
                            {hours.map((hour, index) => {
                                // Hour 12 is at the top (0 degrees position in clock space).
                                const hourValue = hour === 12 ? 0 : hour; 
                                // The formula: (hour * 30) degrees clockwise, offset by -90 to start 0 at the top.
                                const correctedAngle = (hourValue * 30) - 90; 

                                const radian = correctedAngle * (Math.PI / 180);
                                const x = Math.cos(radian) * 100 + 192;
                                const y = Math.sin(radian) * 100 + 192;
                                
                                return (
                                    <div
                                        key={`hour-${hour}`}
                                        className="absolute w-12 h-12 bg-green-400 rounded-full flex items-center justify-center font-bold text-lg shadow-md transform -translate-x-1/2 -translate-y-1/2"
                                        style={{ left: `${x}px`, top: `${y}px` }}
                                    >
                                        {hour}
                                    </div>
                                );
                            })}
                            
                            {/* Center elements (clock face and hands) */}
                            <div className="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-32 h-32 bg-white border-4 border-gray-300 rounded-full shadow-inner flex items-center justify-center">
                                <div className="relative w-full h-full">
                                    {[...Array(12)].map((_, i) => {
                                        const angle = (i * 30) - 90;
                                        return (
                                            <div
                                                key={i}
                                                className="absolute w-0.5 h-2 bg-gray-400"
                                                style={{
                                                    left: '50%',
                                                    top: '10px',
                                                    transform: `translateX(-50%) rotate(${angle + 90}deg)`,
                                                    transformOrigin: `center ${56}px`
                                                }}
                                            />
                                        );
                                    })}
                                </div>
                            </div>
                            
                            {/* Hour hand */}
                            <div 
                                className="absolute cursor-pointer z-20"
                                style={{ 
                                    left: '50%',
                                    top: '50%',
                                    width: '8px',
                                    height: '60px',
                                    transform: `translate(-50%, -50%) rotate(${hourRotation}deg)`,
                                    transformOrigin: 'center center'
                                }}
                                onMouseDown={() => handleMouseDown('hour')}
                            >
                                <div className="w-full h-full bg-blue-600 rounded-full shadow-lg" style={{ transformOrigin: 'center bottom', transform: 'translateY(-50%)' }}></div>
                                <div className="absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-6 h-6 bg-blue-700 rounded-full border-2 border-white shadow-lg"></div>
                            </div>
                            
                            {/* Minute hand */}
                            <div 
                                className="absolute cursor-pointer z-10"
                                style={{ 
                                    left: '50%',
                                    top: '50%',
                                    width: '6px',
                                    height: '90px',
                                    transform: `translate(-50%, -50%) rotate(${minuteRotation}deg)`,
                                    transformOrigin: 'center center'
                                }}
                                onMouseDown={() => handleMouseDown('minute')}
                            >
                                <div className="w-full h-full bg-red-500 rounded-full shadow-lg" style={{ transformOrigin: 'center bottom', transform: 'translateY(-50%)' }}></div>
                                <div className="absolute top-0 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-5 h-5 bg-red-600 rounded-full border-2 border-white shadow-lg"></div>
                            </div>
                            
                            {/* Center dot */}
                            <div className="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-4 h-4 bg-gray-800 rounded-full z-30"></div>
                        </div>
                    </div>

                    {/* Current Time Display */}
                    <div className="bg-white rounded-2xl shadow-lg p-6 mb-4">
                        <div className="text-center">
                            <div className="text-5xl font-bold text-gray-800">
                                {getCurrentHour()}:{getCurrentMinute().toString().padStart(2, '0')}
                            </div>
                        </div>
                    </div>

                    {/* Reset Button (Simplified to remove icon dependency) */}
                    <button
                        onClick={() => {
                            setHourRotation(0);
                            setMinuteRotation(0);
                        }}
                        className="flex items-center gap-2 bg-blue-500 hover:bg-blue-600 text-white font-semibold px-6 py-3 rounded-full shadow-lg transition-colors"
                    >
                        â†» Reset
                    </button>
                </div>
            );
        }

        // Render the component
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<SpinningClock />);
    </script>
</body>
</html>
